name: execute 

# Allow repository modyfication;
permissions:
  contents: write

on:
  # Allow to re-use this jobs;
  workflow_call:

jobs:
  execute:
    runs-on: ubuntu-latest
      
    defaults:
      run:
        shell: bash
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Retrieve saved distrobuilder configuration 
        uses: actions/download-artifact@v3
        with:
          name: debian.yml 
          path: ./ansible/debian.yml

      - name: Prepare 
        run: |
          make execute 

      - name: Temporarily save LXC image
        uses: actions/upload-artifact@v3
        with:
          name: rootfs.tar.xz 
          path: ./ansible/rootfs.tar.xz
